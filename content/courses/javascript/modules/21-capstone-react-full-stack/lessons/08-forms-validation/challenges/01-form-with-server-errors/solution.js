// See code section above for complete implementation