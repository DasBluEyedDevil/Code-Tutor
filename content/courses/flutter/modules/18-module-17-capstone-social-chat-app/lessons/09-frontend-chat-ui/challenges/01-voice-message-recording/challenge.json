{
  "type": "FREE_CODING",
  "id": "18.9-challenge-0",
  "title": "Voice Message Recording",
  "description": "Implement a hold-to-record voice message feature with waveform visualization during recording and playback controls in the chat.",
  "instructions": "Build a comprehensive voice message system:\n\n1. Create a hold-to-record button that starts recording on press and stops on release\n2. Show a recording indicator with elapsed time and waveform visualization\n3. Implement a cancel gesture by swiping left while holding\n4. Display voice messages with waveform preview and duration\n5. Add playback controls with progress indicator and play/pause button\n6. Support audio focus management (pause other audio when playing)\n7. Handle microphone permissions properly",
  "language": "dart",
  "testCases": [],
  "hints": [
    {
      "level": 1,
      "text": "Use the record package for audio recording and just_audio for playback"
    },
    {
      "level": 2,
      "text": "For waveform visualization, sample the audio amplitude during recording and store as a list of normalized values"
    },
    {
      "level": 3,
      "text": "Use GestureDetector's onLongPressStart/End/MoveUpdate for the hold-to-record and swipe-to-cancel gesture"
    }
  ],
  "commonMistakes": [
    {
      "mistake": "Not handling audio focus when multiple voice messages exist",
      "consequence": "Multiple voice messages play simultaneously causing confusion",
      "correction": "Use a global audio player provider that stops the current playback before starting a new one"
    },
    {
      "mistake": "Recording continues when user navigates away",
      "consequence": "Orphaned recordings waste storage and resources",
      "correction": "Cancel recording in dispose() and when the widget is removed from the tree"
    }
  ],
  "difficulty": "advanced"
}