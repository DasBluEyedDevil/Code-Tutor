<UserControl x:Class="CodeTutor.Wpf.Controls.CodingChallenge"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit">

    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,24">
        <StackPanel>
            <!-- Challenge Header -->
            <TextBlock x:Name="ChallengeTitle"
                       Style="{StaticResource SubheadingText}"
                       Margin="0,0,0,8" />
            <TextBlock x:Name="Description"
                       Style="{StaticResource BodyText}"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="0,0,0,16" />

            <!-- Instructions -->
            <Border Background="{StaticResource BackgroundLightBrush}"
                    CornerRadius="6"
                    Padding="12"
                    Margin="0,0,0,16">
                <TextBlock x:Name="Instructions"
                           Style="{StaticResource CaptionText}"
                           TextWrapping="Wrap" />
            </Border>

            <!-- Code Editor -->
            <Border Background="#0D1117"
                    BorderBrush="{StaticResource BorderDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    MinHeight="200"
                    Margin="0,0,0,16">
                <avalonEdit:TextEditor x:Name="CodeEditor"
                                        FontFamily="{StaticResource MonoFont}"
                                        FontSize="13"
                                        ShowLineNumbers="True"
                                        Background="Transparent"
                                        Foreground="{StaticResource TextPrimaryBrush}"
                                        LineNumbersForeground="{StaticResource TextMutedBrush}" />
            </Border>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                <Button Style="{StaticResource PrimaryButton}"
                        Click="RunCode_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Run Code" />
                    </StackPanel>
                </Button>

                <Button x:Name="HintButton"
                        Style="{StaticResource SecondaryButton}"
                        Click="ShowHint_Click"
                        Margin="12,0,0,0">
                    <TextBlock Text="Show Hint" />
                </Button>

                <Button Style="{StaticResource GhostButton}"
                        Click="ShowSolution_Click"
                        Margin="12,0,0,0">
                    <TextBlock Text="Show Solution" />
                </Button>

                <Button Style="{StaticResource GhostButton}"
                        Click="Reset_Click"
                        Margin="12,0,0,0">
                    <TextBlock Text="Reset" />
                </Button>
            </StackPanel>

            <!-- Output Panel -->
            <Border x:Name="OutputPanel"
                    Background="{StaticResource BackgroundDarkBrush}"
                    BorderBrush="{StaticResource BorderDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12"
                    MinHeight="80"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Output:"
                               Style="{StaticResource CaptionText}"
                               Margin="0,0,0,8" />
                    <TextBlock x:Name="OutputText"
                               Style="{StaticResource CodeText}"
                               TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <!-- Test Results Panel -->
            <Border x:Name="TestResultsPanel"
                    Background="{StaticResource BackgroundDarkBrush}"
                    BorderBrush="{StaticResource BorderDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12"
                    Margin="0,8,0,0"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Test Results:"
                               Style="{StaticResource CaptionText}"
                               Margin="0,0,0,8" />
                    <ItemsControl x:Name="TestResultsList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="{Binding Status}"
                                               Foreground="{Binding Color}"
                                               FontFamily="Segoe UI Symbol"
                                               Margin="0,0,8,0" />
                                    <TextBlock Text="{Binding Description}"
                                               Style="{StaticResource CaptionText}" />
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <TextBlock x:Name="TestSummary"
                               Style="{StaticResource BodyText}"
                               Margin="0,8,0,0" />
                </StackPanel>
            </Border>

            <!-- Hint Panel -->
            <Border x:Name="HintPanel"
                    Background="#1A1F2A"
                    BorderBrush="{StaticResource AccentOrangeBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12"
                    Margin="0,8,0,0"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Hint"
                               Style="{StaticResource CaptionText}"
                               Foreground="{StaticResource AccentOrangeBrush}"
                               Margin="0,0,0,4" />
                    <TextBlock x:Name="HintText"
                               Style="{StaticResource BodyText}"
                               TextWrapping="Wrap" />
                </StackPanel>
            </Border>
        </StackPanel>
    </Border>
</UserControl>
