---
phase: 04-csharp-course-audit
plan: 05
type: execute
wave: 3
depends_on: ["04-02", "04-03", "04-04"]
files_modified:
  - content/courses/csharp/modules/**/content/*-key_point.md (131 new files)
  - content/courses/csharp/modules/**/challenges/**/*.cs (read + verify + 3 C# 13 fallbacks)
  - content/courses/csharp/**/*.json (validation)
  - content/courses/csharp/course.json (final metadata check)
autonomous: false

must_haves:
  truths:
    - "Every one of 132 lessons has at least one KEY_POINT section"
    - "KEY_POINTs are specific and actionable (not generic platitudes)"
    - "All M01-10 challenge solution.cs files execute successfully as C# top-level statements in Roslyn (excluding 3 C# 13 challenges which get C# 12 fallback versions)"
    - "All challenge.json files parse as valid JSON"
    - "All lesson.json files parse as valid JSON"
    - "Global sweep returns fewer than 5 stale .NET 8 references, each verified as intentional historical/legacy context"
    - "Voice is consistent across all 24 modules"
    - "No knowledge cliffs at module transitions"
  artifacts:
    - path: "content/courses/csharp/modules/01-getting-started-with-c/lessons/01-what-is-programming/content/*-key_point.md"
      provides: "KEY_POINT for first lesson (representative)"
      contains: "KEY_POINT"
    - path: ".planning/phases/04-csharp-course-audit/04-05-SUMMARY.md"
      provides: "Final phase results"
  key_links:
    - from: "KEY_POINT frontmatter type"
      to: "key_point.md filename"
      via: "naming consistency"
      pattern: "key_point\\.md$"
    - from: "challenge solution.cs"
      to: "Roslyn executor compatibility"
      via: "top-level statements"
      pattern: "Console\\.Write|var |int |string "
---

<objective>
Add KEY_POINT sections to all 131 lessons that lack them (only lesson 14-03 has one). Validate all challenge files (JSON validity, solution code review). Perform a global sweep for remaining issues. Final human verification checkpoint.

Purpose: CSRP-05 requires every lesson to have at least one KEY_POINT. This is the single largest content addition task (131 new files). Challenge validation ensures CSRP-03. The global sweep catches anything missed by the three accuracy passes. Human checkpoint gates the phase completion.

Output: 131 new KEY_POINT files, validated challenges, clean global sweep, human-approved course.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-csharp-course-audit/04-RESEARCH.md
@.planning/phases/04-csharp-course-audit/04-01-SUMMARY.md
@.planning/phases/04-csharp-course-audit/04-02-SUMMARY.md
@.planning/phases/04-csharp-course-audit/04-03-SUMMARY.md
@.planning/phases/04-csharp-course-audit/04-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: KEY_POINT enrichment for all 131 lessons</name>
  <files>
    content/courses/csharp/modules/**/content/*-key_point.md (131 new files)
  </files>
  <action>
    Create a KEY_POINT markdown file for each of the 131 lessons that currently lack one. (Lesson 14-03 already has a KEY_POINT -- skip it.)

    **KEY_POINT file format:**
    ```markdown
    ---
    type: KEY_POINT
    title: "[Specific takeaway title]"
    ---

    [1-3 concise key points for the lesson. Each should be:
    - Specific to this lesson's content (not generic)
    - Actionable (student knows what to DO with this knowledge)
    - Memorable (could serve as a study review item)]
    ```

    **Naming convention:** Use the next available numeric prefix in the lesson's content directory. For example, if a lesson has files 01-analogy.md through 05-theory.md, create 06-key_point.md.

    **Quality guidelines for KEY_POINTs:**

    | Module Type | KEY_POINT Style | Example |
    |-------------|-----------------|---------|
    | Fundamentals (M01-04) | "Remember this rule" | "Variables declared with `const` cannot be reassigned. Use `const` by default, switch to regular variables only when you need to change the value." |
    | Core C# (M05-10) | "When to use this" | "Use `CountBy()` when you need group counts without materializing groups. It's more efficient than `GroupBy().Select(g => g.Count())` for large datasets." |
    | Frameworks (M11-16) | "The pattern to follow" | "Always register services in `Program.cs` before building the app. The order is: `builder.Services.Add*()` first, then `builder.Build()`, then `app.Map*()` and middleware." |
    | Advanced (M17-24) | "The decision to make" | "Choose Native AOT when startup time matters (serverless, CLI tools). Choose regular JIT when you need reflection, dynamic loading, or maximum compatibility." |

    **IMPORTANT: Read each lesson's content before writing its KEY_POINT.** The KEY_POINT must be derived from what the lesson actually teaches, not from generic knowledge of the topic. Skim the theory and example files to identify the core takeaway.

    **Batch approach:** Process modules in groups:
    - Batch 1: M01-06 (35 lessons) -- commit after
    - Batch 2: M07-12 (39 lessons) -- commit after
    - Batch 3: M13-18 (30 lessons, skip 14-03) -- commit after
    - Batch 4: M19-24 (27 lessons) -- commit after

    Commits:
    - "feat(04-05): add KEY_POINTs to M01-06 (35 lessons)"
    - "feat(04-05): add KEY_POINTs to M07-12 (39 lessons)"
    - "feat(04-05): add KEY_POINTs to M13-18 (30 lessons)"
    - "feat(04-05): add KEY_POINTs to M19-24 (27 lessons)"
  </action>
  <verify>
    - `find content/courses/csharp -name '*-key_point.md' | wc -l` returns 132 (131 new + 1 existing)
    - All new KEY_POINT files have correct frontmatter (type: KEY_POINT, title present)
    - Spot-check 5 random KEY_POINTs: each is specific to its lesson (not generic)
    - No KEY_POINT is longer than ~200 words (concise, not essay-length)
  </verify>
  <done>131 KEY_POINT sections created. Every lesson in the C# course now has at least one KEY_POINT. All are specific, actionable, and derived from actual lesson content.</done>
</task>

<task type="auto">
  <name>Task 2: Challenge validation + global sweep</name>
  <files>
    content/courses/csharp/modules/**/challenges/**/*.cs (review)
    content/courses/csharp/modules/**/challenges/**/challenge.json (validate)
    content/courses/csharp/**/lesson.json (validate)
    content/courses/csharp/**/module.json (validate)
    content/courses/csharp/course.json (validate)
  </files>
  <action>
    **Part A: JSON Validation**

    Validate EVERY JSON file in the C# course:
    1. All challenge.json files parse as valid JSON
    2. All lesson.json files parse as valid JSON
    3. All module.json files parse as valid JSON
    4. course.json parses as valid JSON
    Report and fix any invalid JSON (unescaped quotes, trailing commas, etc.)

    **Part B: Challenge Execution Validation (Modules 01-10)**

    For Modules 01-10 (pure C# challenges that CAN run in Roslyn):
    1. Read each solution.cs file
    2. Verify it uses top-level statements (no class wrapping, no Main method)
    3. Verify it uses only BCL types (System.*, System.Collections.Generic.*, System.Linq.*)
    4. For the 3 challenges using C# 13 features (M05 L06 implicit index, M06 L08 params collections, M10 L05 Lock type):
       - Create a C# 12-compatible fallback version of the challenge solution that teaches the same concept using C# 12 patterns
       - Add `"roslynCompatibility": "c#12-fallback"` to the challenge.json metadata for these 3 challenges
       - Keep the original C# 13 solution as a `solution-c13.cs` alongside the C# 12 `solution.cs`
    5. Verify each starter.cs provides meaningful scaffolding (not empty, not complete solution)
    6. For all C# 12-compatible challenges in M01-10 (~54 challenges), verify solutions are syntactically valid by reviewing them for correct top-level statement structure and BCL-only imports

    **Part C: Challenge Review (Modules 11-24)**

    For Modules 11-24 (framework-dependent, cannot run in Roslyn):
    1. Spot-check 10-15 representative solution.cs files across these modules
    2. Verify they reference current .NET 9 APIs
    3. Verify they are syntactically plausible (even though they can't execute in Roslyn)
    4. No need to check every file -- these are conceptual/review challenges

    **Part D: Global Sweep**

    Run comprehensive searches across the ENTIRE C# course:
    ```
    # Stale .NET 8 refs (should be minimal after accuracy passes)
    grep -r "net8\.0\|\.NET 8\.0\|dotnet 8" content/courses/csharp/ --include="*.md" | grep -v "introduced\|legacy\|historical\|previously"

    # Non-standard filenames (should be zero after 04-01)
    find content/courses/csharp -name '*-architecture.md' -o -name '*-real_world.md' -o -name '*-deep_dive.md'

    # Artifact files
    find content/courses/csharp -name "*.py" -o -name "*.pyc" -o -name "*.bak"

    # Orphaned content (files not matching known patterns)
    find content/courses/csharp/modules -name "*.md" | grep -v -E "(theory|example|analogy|warning|key_point)\.md$" | head -20
    ```

    Fix any remaining issues found.

    Commit: "fix(04-05): validate challenges, fix JSON, global sweep for remaining issues"
  </action>
  <verify>
    - All JSON files parse without errors
    - `find content/courses/csharp -name '*-architecture.md' -o -name '*-real_world.md' -o -name '*-deep_dive.md' | wc -l` returns 0
    - `find content/courses/csharp -name "*.py" | wc -l` returns 0
    - C# 13 challenges in M05/M06/M10 have C# 12 fallback solutions (solution.cs) and C# 13 originals (solution-c13.cs)
    - challenge.json for the 3 C# 13 challenges includes "roslynCompatibility": "c#12-fallback"
    - All M01-10 challenge solution.cs files use top-level statements and BCL-only types
    - Stale .NET 8 reference count is <5, each verified as intentional historical/legacy context
  </verify>
  <done>All JSON validated. M01-10 challenges verified with C# 12 fallbacks for 3 C# 13 challenges. M11-24 challenges spot-checked. Global sweep clean: zero non-standard files, zero artifacts, <5 stale version references (all verified historical).</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Human verification of complete C# course audit</name>
  <action>
    Present the completed audit results to the user for final verification. All automated work (Plans 04-01 through 04-05 Tasks 1-2) has been completed. The user verifies the results by spot-checking key changes in the WPF app.
  </action>
  <what-built>
    Complete C# course audit: 132 lessons across 24 modules verified against C# 13/.NET 9. Key changes:
    - Version manifest updated from .NET 8/C# 12 to .NET 9/C# 13
    - course.json updated (estimatedHours: 100, minimumRuntimeVersion: .NET 9.0, accurate description)
    - 24 non-standard filenames renamed (architecture.md, real_world.md, deep_dive.md)
    - refactor_course.py artifact deleted
    - C# 12 vs C# 13 feature boundaries correctly documented
    - .NET 9-only APIs marked (CountBy, AggregateBy, HybridCache, built-in OpenAPI, Lock type)
    - WARNING sections added to Module 12 (all 8 lessons), M18, M22, M23, M24
    - 131 KEY_POINT sections added (was 1, now 132)
    - All JSON files validated
    - Challenge code reviewed (M01-10 Roslyn-compatible, M11-24 spot-checked)
    - Capstone ShopFlow structure verified
  </what-built>
  <how-to-verify>
    1. Open the WPF app and navigate to the C# course
    2. Verify course description mentions ".NET 9" and "132 lessons"
    3. Navigate to Module 01 Lesson 01 -- verify KEY_POINT section renders correctly
    4. Navigate to Module 05 Lesson 06 (implicit index) -- verify C# 13 stated
    5. Navigate to Module 09 Lesson 07 (CountBy) -- verify .NET 9 stated
    6. Navigate to Module 12 Lesson 03 (migrations) -- verify WARNING section exists and renders
    7. Navigate to Module 19 Lesson 01 (OpenAPI) -- verify .NET 9 built-in OpenAPI description
    8. Navigate to Module 24 Lesson 01 (capstone intro) -- verify it references ShopFlow project
    9. Open a Module 01 challenge -- verify solution code is visible and appears correct
    10. Spot-check a Module 15 KEY_POINT -- verify it's specific to that testing lesson
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
1. Every lesson has a KEY_POINT section (132/132)
2. All JSON files valid
3. Challenge code reviewed for correctness
4. Global sweep confirms zero remaining issues
5. Human has verified key changes in the app
</verification>

<success_criteria>
- CSRP-01 FULLY satisfied: Every C# lesson verified against C# 13/.NET 9
- CSRP-02 FULLY satisfied: All 132 lessons progress smoothly from fundamentals to deployment
- CSRP-03 FULLY satisfied: M01-10 challenges verified for Roslyn C# 12 compatibility (3 C# 13 challenges have C# 12 fallbacks); M11-24 challenges code-reviewed (framework-dependent, cannot execute in Roslyn)
- CSRP-04 FULLY satisfied: ShopFlow capstone exists with verified structure and deployment instructions
- CSRP-05 FULLY satisfied: Every lesson has at least one KEY_POINT section (132/132)
</success_criteria>

<output>
After completion, create `.planning/phases/04-csharp-course-audit/04-05-SUMMARY.md`

The SUMMARY must include:
- KEY_POINT creation count per module batch
- Challenge validation results (JSON validity, code review findings)
- Global sweep results (fixes per category)
- Roslyn compatibility assessment for C# 13 challenges
- Voice consistency assessment
- Final phase checklist (all CSRP requirements)
- Recommendation on whether Phase 4.1 is needed
</output>
