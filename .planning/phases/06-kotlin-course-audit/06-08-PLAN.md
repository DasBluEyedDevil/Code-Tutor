---
phase: 06-kotlin-course-audit
plan: 08
type: execute
wave: 4
depends_on: ["06-03", "06-04"]
files_modified:
  - content/courses/kotlin/modules/12-professional-development-deployment/lessons/*/content/*.md (M12 L08 update)
  - New capstone lesson content in M12 or new module
autonomous: true

must_haves:
  truths:
    - "A capstone project description exists that uses Ktor + Compose Multiplatform (not Jetpack Compose)"
    - "Capstone builds on Module 06 Task Management API as foundation"
    - "Capstone demonstrates KMP shared code (commonMain), Android target, Desktop target minimum"
    - "Capstone uses technologies from across the course: Ktor, Exposed, Koin, SQLDelight, Compose MP, kotlinx.serialization"
    - "Capstone can be built locally without cloud accounts or external services"
  artifacts:
    - path: "content/courses/kotlin/modules/12-professional-development-deployment/lessons/*/content/*-theory.md"
      provides: "Capstone project description and architecture"
    - path: "content/courses/kotlin/modules/12-professional-development-deployment/lessons/*/content/*-example.md"
      provides: "Capstone code examples (build config, shared module, server, client)"
  key_links:
    - from: "Capstone Ktor server"
      to: "M06 Task Management API patterns"
      via: "Extends the API built in Module 06"
      pattern: "ktor|routing|Exposed"
    - from: "Capstone Compose MP client"
      to: "M07 Compose patterns"
      via: "Uses UI patterns from Module 07"
      pattern: "@Composable|remember|ViewModel"
    - from: "Capstone SQLDelight cache"
      to: "M08 SQLDelight patterns"
      via: "Client-side caching using patterns from Module 08"
      pattern: "sqldelight|SqlDriver"
---

<objective>
Create the Kotlin course capstone project -- a Task Management App using Ktor backend + Compose Multiplatform frontend + SQLDelight local cache, building on the M06 Task Management API. Update the existing M12 capstone lesson content to describe this KMP project instead of the Android-only ShopKotlin.

Purpose: KTLN-04 requires a deployable capstone project. The existing M12 L08 describes "ShopKotlin" using Jetpack Compose (Android-only), which contradicts the "Kotlin Multiplatform Complete Course" title. The new capstone should demonstrate the full KMP stack and be buildable locally.
Output: Comprehensive capstone project content across 6-8 lesson content files (theory + examples), updating existing M12 capstone lessons.
</objective>

<execution_context>
@C:\Users\dasbl\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dasbl\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-kotlin-course-audit/06-RESEARCH.md
@.planning/phases/06-kotlin-course-audit/06-03-SUMMARY.md
@.planning/phases/06-kotlin-course-audit/06-04-SUMMARY.md
@content/version-manifest.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Design capstone architecture and update M12 capstone lessons</name>
  <files>
    content/courses/kotlin/modules/12-professional-development-deployment/lessons/*/content/*.md
  </files>
  <action>
    **Step 1: Assess existing M12 capstone content**
    Read ALL lesson.json files in M12 to identify which lessons are capstone-related. Research says M12 L08 contains the ShopKotlin capstone. There may be additional capstone-adjacent lessons (deployment, CI/CD for the project).

    Read the M12 L08 content files to understand what currently exists:
    - How much content is there? (full project guide vs. overview)
    - What technologies does it describe?
    - How many content files (theory, example, etc.)?

    **Step 2: Design the Task Manager KMP capstone**
    The capstone is a Task Management App that extends the M06 API:

    **Architecture:**
    ```
    task-manager-kmp/
    ├── server/                    # Ktor backend (extends M06 capstone)
    │   ├── src/main/kotlin/
    │   │   ├── Application.kt    # Ktor server with Koin DI
    │   │   ├── routes/           # Task CRUD + Auth routes
    │   │   ├── models/           # Exposed table definitions
    │   │   └── repository/       # Repository pattern
    │   └── build.gradle.kts
    ├── shared/                    # KMP shared module (commonMain)
    │   ├── src/commonMain/kotlin/
    │   │   ├── domain/           # Task, User domain models
    │   │   ├── data/             # Repository interfaces, DTOs
    │   │   └── di/               # Koin modules
    │   ├── src/androidMain/      # Android-specific implementations
    │   └── src/desktopMain/      # Desktop-specific implementations
    ├── composeApp/                # Compose Multiplatform client
    │   ├── src/commonMain/kotlin/
    │   │   ├── ui/               # Composable screens (TaskList, TaskDetail, Login)
    │   │   ├── viewmodel/        # ViewModels using shared domain
    │   │   └── navigation/       # Navigation graph
    │   ├── src/androidMain/      # Android entry point
    │   └── src/desktopMain/      # Desktop entry point
    └── gradle/libs.versions.toml  # Version catalog
    ```

    **Technologies demonstrated:**
    - Ktor 3.4.0 server with CIO engine (M06)
    - Exposed 1.0.0 with H2 database (M06, no PostgreSQL needed)
    - JWT authentication (M06 auth lessons)
    - Koin 4.1.x DI across server and client (M10)
    - Compose Multiplatform UI (M07)
    - SQLDelight client-side cache (M08)
    - kotlinx.serialization for API communication (M06)
    - kotlinx.coroutines for async operations (M05)
    - Gradle version catalogs (M13)
    - kotlin.test for shared tests (M11)

    **Features:**
    1. User registration and login (JWT)
    2. Task CRUD (create, read, update, delete)
    3. Task categories and priorities
    4. Offline-first with SQLDelight cache + Ktor sync
    5. Material 3 UI with responsive design

    **Step 3: Rewrite M12 capstone content**
    Replace the ShopKotlin Jetpack Compose content with the Task Manager KMP content.

    If M12 has a single capstone lesson (L08), expand it or use the existing lesson structure. If M12 has multiple capstone-related lessons, update each accordingly.

    Content files to create/update for the capstone lesson(s):

    **Theory file(s):**
    - Capstone overview: Project goals, architecture diagram (text-based), technology choices
    - Why each technology was chosen (connecting back to the module where it was taught)
    - Project setup instructions (using KMP Wizard or manual Gradle setup)

    **Example file(s):**
    - build.gradle.kts examples for the KMP project structure
    - libs.versions.toml with all dependency versions
    - Key code examples: shared domain models, Ktor server setup, Compose UI screens
    - Include enough code that students can follow along without a separate project directory

    **Key Point file(s):**
    - "The capstone combines every major topic: Ktor (M06), Compose MP (M07), SQLDelight (M08), Koin (M10), testing (M11), Gradle (M13)"
    - "Using H2 embedded database means no PostgreSQL setup needed for local development"

    If the existing ShopKotlin content has value (e-commerce patterns), keep 1-2 paragraphs as a "Case Study: Alternative Capstone Ideas" section, but the primary capstone is the Task Manager.
  </action>
  <verify>
    Read the updated M12 capstone lesson content and verify:
    - Architecture uses Compose Multiplatform (not Jetpack Compose)
    - Project structure includes shared/, server/, composeApp/ (KMP structure)
    - Technologies reference modules where they were taught
    - H2 database (no external database needed)
    - build.gradle.kts uses version catalogs
    Grep for "Jetpack Compose" in M12 -- should only appear in historical context or comparison, not as the capstone technology.
    Grep for "ShopKotlin" -- should be removed or relegated to "alternative ideas" section.
  </verify>
  <done>
    M12 capstone rewritten as Task Manager KMP app using Ktor + Compose Multiplatform + SQLDelight + Koin. Architecture described with code examples. Project buildable locally with H2 database. ShopKotlin Android-only content replaced or relegated.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create capstone step-by-step implementation guide</name>
  <files>
    content/courses/kotlin/modules/12-professional-development-deployment/lessons/*/content/*.md
  </files>
  <action>
    Extend the capstone content with a step-by-step implementation guide that students can follow. This goes in the same lesson(s) as Task 1, as additional content files.

    **Implementation steps (each gets detailed code in example content files):**

    1. **Project Setup** (example file):
       - Initialize KMP project with Compose Multiplatform
       - Configure gradle/libs.versions.toml with all dependencies:
         ```toml
         [versions]
         kotlin = "2.3.0"
         ktor = "3.4.0"
         exposed = "1.0.0"
         koin = "4.1.1"
         sqldelight = "2.2.1"
         compose = "1.10.0"
         ```
       - Set up project modules (server, shared, composeApp)

    2. **Shared Domain Layer** (example file):
       - Task data class with @Serializable
       - User data class with @Serializable
       - TaskRepository interface in commonMain
       - TaskFilter/TaskSort sealed classes

    3. **Server Implementation** (example file):
       - Ktor Application.kt with modules
       - Exposed table definitions (Tasks, Users)
       - Repository implementation
       - Auth routes (register, login, JWT)
       - Task CRUD routes
       - Koin server module configuration

    4. **Client-Side Cache** (example file):
       - SQLDelight .sq files for local task cache
       - Platform-specific SqlDriver expect/actual
       - SyncManager that syncs local cache with server

    5. **Compose UI** (example file):
       - TaskListScreen @Composable
       - TaskDetailScreen @Composable
       - LoginScreen @Composable
       - Navigation setup
       - ViewModel integration with Koin

    6. **Running and Testing** (example file):
       - How to run the server locally
       - How to run Android app
       - How to run Desktop app
       - Basic integration test example

    Each step should include COMPLETE, RUNNABLE code snippets (not abbreviated with "..."). Students should be able to copy these into their project files.

    Keep all content in existing M12 lesson structure -- add content files to the capstone lesson(s), do not create new lessons.
  </action>
  <verify>
    Count total content files in the capstone lesson(s).
    Verify code examples include all imports (no "import ..." abbreviations).
    Verify build.gradle.kts examples match version-manifest.json versions.
    Verify server code uses Ktor 3.4.0 patterns (from M06 accuracy pass).
    Verify Compose code uses CMP patterns (from M07 accuracy pass).
    Verify no external service dependencies (PostgreSQL, Redis, etc.) -- only H2 and local execution.
  </verify>
  <done>
    Capstone step-by-step guide complete with 6 implementation steps. Each step has complete code examples with imports. Project runs locally with H2 database. Students can build Android + Desktop apps from shared KMP codebase.
  </done>
</task>

</tasks>

<verification>
1. Capstone uses Compose Multiplatform (not Jetpack Compose)
2. Capstone builds on M06 Task Management API
3. Project structure is KMP (shared/, server/, composeApp/)
4. All version numbers match version-manifest.json
5. No external service dependencies
6. Step-by-step guide has complete code examples
7. Technologies from across the course are demonstrated (Ktor, Exposed, Koin, SQLDelight, CMP, coroutines, Gradle)
</verification>

<success_criteria>
- KTLN-04 addressed: Capstone project exists using KMP stack
- Capstone is buildable locally without cloud accounts
- Content connects back to modules where each technology was taught
- Code examples are complete and accurate against verified framework versions
- ShopKotlin Android-only content replaced with KMP approach
</success_criteria>

<output>
After completion, create `.planning/phases/06-kotlin-course-audit/06-08-SUMMARY.md`
</output>
