---
phase: 06-kotlin-course-audit
plan: 10
type: execute
wave: 6
depends_on: ["06-09"]
files_modified:
  - content/courses/kotlin/modules/*/lessons/*/lesson.json (validation)
  - content/courses/kotlin/modules/*/module.json (validation)
  - content/courses/kotlin/modules/*/lessons/*/challenges/*/challenge.json (validation)
  - content/courses/kotlin/course.json (validation)
autonomous: false

must_haves:
  truths:
    - "All JSON files in the Kotlin course validate (course.json, module.json, lesson.json, challenge.json)"
    - "Zero stale version references remain (Kotlin 2.0, Ktor 3.x unspecified, Compose 1.7.x, old version manifest values)"
    - "Module 06 lesson order is verified correct in rendered order"
    - "No non-standard content filenames (experiment, concept, architecture, etc.)"
    - "Human approves the phase as complete"
  artifacts:
    - path: "content/courses/kotlin/course.json"
      provides: "Valid course metadata"
    - path: "content/courses/kotlin/modules/*/module.json"
      provides: "Valid module metadata for all 15 modules"
  key_links:
    - from: "version-manifest.json Kotlin 2.3"
      to: "course.json minimumRuntimeVersion"
      via: "Version consistency"
      pattern: "2\\.3"
    - from: "All challenge.json"
      to: "solution.kt existence"
      via: "Every challenge has a solution"
      pattern: "challenge\\.json"
---

<objective>
Final global verification sweep across the entire Kotlin course: validate all JSON files, sweep for stale version references, verify the M06 reorder stuck, check for non-standard filenames, and get human approval.

Purpose: This is the final quality gate before marking Phase 6 complete. It catches anything missed by individual accuracy passes and challenge creation plans. The human checkpoint confirms the course is production-ready.
Output: Validation report, any final fixes, human approval.
</objective>

<execution_context>
@C:\Users\dasbl\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dasbl\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-kotlin-course-audit/06-RESEARCH.md
@content/version-manifest.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: JSON validation + stale reference sweep + structural verification</name>
  <files>
    All JSON files under content/courses/kotlin/
    All content files under content/courses/kotlin/modules/*/lessons/*/content/
  </files>
  <action>
    **JSON Validation:**
    Validate every JSON file in the Kotlin course directory:
    1. course.json -- valid JSON, required fields present
    2. All 15 module.json files -- valid JSON, order field present, title is descriptive (no "Module XXX:" prefixes)
    3. All 128 lesson.json files -- valid JSON, order field present, id matches pattern
    4. All challenge.json files (should be 128+ after challenge creation) -- valid JSON, required fields

    Use `python -c "import json; json.load(open('file'))"` or similar for each file. Report total files validated and any invalid files.

    **Stale Version Reference Sweep:**
    Search all content files (.md) under the Kotlin course for outdated version references:
    - "Kotlin 2.0" (should be "Kotlin 2.3" unless in historical context)
    - "Kotlin 1." followed by version numbers (should not appear except in legacy/migration context)
    - "Ktor 2." (should be Ktor 3.x)
    - "Compose 1.7" or "Compose Multiplatform 1.7" (should be 1.10.x)
    - "Koin 3." (should be Koin 4.x)
    - "Exposed 0." (should be Exposed 1.0.x)
    - "context(Raise" without a parameter name (should be "context(raise: Raise" -- outside migration sections)
    - "kotlinOptions" in Gradle (should be "compilerOptions")
    - "Module 04A" or "Module 06A/B/C" (should be removed from all content, not just module.json)

    For each stale reference found:
    - If in a migration/legacy/historical context: KEEP but verify it's clearly labeled
    - If in current teaching content: FIX to current version
    - Track all changes for the summary

    **Structural Verification:**
    1. Module 06 order: List all M06 lesson directories and verify they follow logical order (HTTP -> Setup -> Routing -> ... -> Capstone)
    2. Module titles: Verify all 15 module.json titles are clean (no prefix artifacts)
    3. Content file types: Grep for non-standard filenames (experiment, concept, architecture, real_world, deep_dive, pitfalls) -- should all have been migrated in Phase 1
    4. Challenge coverage: Count lessons with challenges vs total -- should be 128/128 (100%)
    5. KEY_POINT coverage: Count lessons with KEY_POINT files vs total -- should be 128/128 (100%)
    6. Deleted artifacts: Verify refactor_course.py and course.json.bak are gone
  </action>
  <verify>
    Report: Total JSON files validated, total stale references found and fixed.
    Report: Module 06 order verification (pass/fail).
    Report: Challenge coverage percentage (target: 100%).
    Report: KEY_POINT coverage percentage (target: 100%).
    Report: Non-standard filename count (target: 0).
  </verify>
  <done>
    All JSON files valid. Stale version references swept and fixed. M06 order verified correct. 100% challenge coverage confirmed. 100% KEY_POINT coverage confirmed. Zero non-standard filenames. Course structurally clean.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete Kotlin course audit across 10 plans:
    - Plan 01: Version alignment (Kotlin 2.3, Ktor 3.4.0, 9 frameworks pinned), M06 lesson reorder (15 lessons), module title fixes (4 modules), artifact deletion
    - Plans 02-05: Content accuracy passes across all 128 lessons (M01-M15), including context receivers -> context parameters migration
    - Plans 06-07: Challenge creation (~80 new challenges, 100% coverage from 37%)
    - Plan 08: Capstone creation (Task Manager KMP app with Ktor + Compose Multiplatform + SQLDelight + Koin)
    - Plan 09: Enrichment (~98 KEY_POINTs, ~18 analogies, ~10 warnings)
    - Plan 10: Global verification sweep
  </what-built>
  <how-to-verify>
    1. Open the Code Tutor application and navigate to the Kotlin course
    2. Verify Module 06 (Ktor) lessons appear in logical order: HTTP intro -> Ktor setup -> Routing -> Params -> JSON -> Database -> Repository -> Validation -> Auth -> DI -> Testing -> Capstone
    3. Open a few lessons across different modules (M01, M06, M12, M15) and verify:
       - Content loads correctly
       - KEY_POINT sections are present
       - Code examples look current
    4. Open the capstone lesson(s) in M12 and verify they describe a KMP project (not Android-only)
    5. Check a few challenges across M01 (pure Kotlin) and M13 (Gradle, was 0%)
    6. Verify version-manifest.json shows Kotlin 2.3, Ktor 3.4.x, Exposed 1.0.x

    If any issues found, describe them. Otherwise approve the phase.
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 6, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. All JSON files valid (course, module, lesson, challenge)
2. Zero stale version references (or all justified as historical context)
3. Module 06 order verified correct
4. 100% challenge coverage (128/128 lessons)
5. 100% KEY_POINT coverage (128/128 lessons)
6. Zero non-standard content filenames
7. Human approved the course as production-ready
</verification>

<success_criteria>
- All KTLN requirements satisfied:
  - KTLN-01: Every lesson accurate against Kotlin 2.3+ with K2 compiler
  - KTLN-02: Progressive curriculum from basics through KMP to deployment
  - KTLN-03: Every lesson has at least one coding challenge (128 challenges, ~80 new)
  - KTLN-04: Capstone project exists (Ktor + Compose Multiplatform Task Manager)
  - KTLN-05: KEY_POINTs throughout (128/128) and content balanced
- Human approves Phase 6 completion
- No Phase 6.1 needed (if issues found, they are minor enough to fix inline)
</success_criteria>

<output>
After completion, create `.planning/phases/06-kotlin-course-audit/06-10-SUMMARY.md`
</output>
