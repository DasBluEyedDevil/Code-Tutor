---
phase: 06-kotlin-course-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - content/version-manifest.json
  - content/courses/kotlin/course.json
  - content/courses/kotlin/modules/05-coroutines-and-flows/module.json
  - content/courses/kotlin/modules/08-persistence-with-sqldelight/module.json
  - content/courses/kotlin/modules/09-kmp-architecture-patterns/module.json
  - content/courses/kotlin/modules/10-dependency-injection-with-koin/module.json
  - content/courses/kotlin/modules/06-backend-development-with-ktor/lessons/*/lesson.json (15 files)
  - content/courses/kotlin/refactor_course.py (deleted)
autonomous: true

must_haves:
  truths:
    - "Version manifest targets Kotlin 2.3/Ktor 3.4.x/Exposed 1.0.x/Koin 4.1.x/Arrow 2.2.x with correct notes"
    - "Module 06 lessons are ordered logically: HTTP intro -> Ktor setup -> routing -> params -> JSON -> DB -> repo -> validation -> auth -> DI -> testing -> capstone"
    - "Module title prefixes (04A, 06A/B/C) are removed from modules 05, 08, 09, 10"
    - "course.json reflects Kotlin 2.3 target with accurate lesson count and difficulty"
    - "refactor_course.py build artifact is deleted"
  artifacts:
    - path: "content/version-manifest.json"
      provides: "Kotlin 2.3 version targets with all frameworks pinned"
      contains: "2.3"
    - path: "content/courses/kotlin/course.json"
      provides: "Updated course metadata"
      contains: "Kotlin 2.3"
    - path: "content/courses/kotlin/modules/06-backend-development-with-ktor/lessons/01-*/lesson.json"
      provides: "Reordered Ktor lessons with correct order fields"
  key_links:
    - from: "content/version-manifest.json"
      to: "content/courses/kotlin/course.json"
      via: "Kotlin version consistency"
      pattern: "2\\.3"
    - from: "Module 06 lesson.json order fields"
      to: "Directory prefix numbers"
      via: "order field matches directory prefix"
      pattern: "order.*[0-9]+"
---

<objective>
Align the Kotlin course to Kotlin 2.3/Ktor 3.4.0, fix the severe Module 06 lesson ordering bug (auth before routing), clean up module title prefixes, update course metadata, and delete the refactor_course.py artifact.

Purpose: Establish correct version targets and fix critical structural issues before content accuracy passes. The M06 ordering bug means students see authentication before learning to set up Ktor -- this must be fixed first. Without correct version targets, accuracy passes would audit against wrong versions.
Output: Updated version-manifest.json, course.json, 4 module.json title fixes, 15 M06 lesson.json reorders, deleted artifact.
</objective>

<execution_context>
@C:\Users\dasbl\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dasbl\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-kotlin-course-audit/06-RESEARCH.md
@content/version-manifest.json
@content/courses/kotlin/course.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Version alignment and course metadata</name>
  <files>
    content/version-manifest.json
    content/courses/kotlin/course.json
  </files>
  <action>
    Update version-manifest.json kotlin section:
    - runtime.version: "2.0" -> "2.3"
    - runtime.notes: "K2 compiler default since 2.0. Kotlin 2.3.0 stable (Dec 2025). Context parameters Beta since 2.2. Course content uses 2.3.0 features."
    - runtime.lastVerified: today's date
    - Ktor: version "3.x" -> "3.4.x", notes: "Server-side web framework. Ktor 3.4.0 (Jan 2026). Course uses ktor-server-core-jvm, ktor-server-cio-jvm, ktor-server-content-negotiation-jvm, ktor-server-auth-jwt-jvm."
    - Compose Multiplatform: version "1.7.x" -> "1.10.x", notes: "Cross-platform UI framework. iOS stable since 1.8 (May 2025). Hot reload since 1.10 (Jan 2026)."
    - SQLDelight: version "2.x" -> "2.2.x", notes: "Multiplatform database library. Type-safe SQL queries, migrations, reactive data flows."
    - Koin: version "4.x" -> "4.1.x", notes: "Dependency injection framework. KMP support with annotations DSL."
    - Add new framework entry: Exposed, version "1.0.x", notes "JetBrains ORM for Ktor. 1.0.0 GA (Jan 2026). R2DBC support added. Used in Module 06 for database operations."
    - Add new framework entry: Arrow, version "2.2.x", notes "Functional programming library. Context parameters API in arrow.core.raise.context. Typed errors with Raise DSL."
    - Add new framework entry: kotlinx-coroutines, version "1.10.x", notes "Structured concurrency. Used throughout course for async operations."
    - Add new framework entry: kotlinx-serialization, version "1.10.x", notes "Multiplatform serialization. Used with Ktor for JSON content negotiation."
    - All framework lastVerified dates updated to today

    Update course.json:
    - minimumRuntimeVersion: "Kotlin 2.0" -> "Kotlin 2.3"
    - difficulty: "beginner" -> "beginner-to-advanced" (course covers basics through production KMP)
    - description: Update to mention Kotlin 2.3, K2 compiler, 128 lessons, 15 modules, Ktor 3.4, Compose Multiplatform, and the full KMP stack
    - estimatedHours: keep 94 (128 lessons; reasonable for framework-dense course)
    - Verify "80+ interactive lessons" in description is accurate (128 lessons exist, 80+ challenges is the goal)

    Delete refactor_course.py artifact (same as done for C# in 04-01):
    - Delete content/courses/kotlin/refactor_course.py
    - Delete content/courses/kotlin/course.json.bak if present
  </action>
  <verify>
    Read version-manifest.json and verify kotlin section shows 2.3, Ktor 3.4.x, all new frameworks added.
    Read course.json and verify minimumRuntimeVersion is "Kotlin 2.3".
    Verify refactor_course.py and course.json.bak are deleted.
  </verify>
  <done>
    Version manifest targets Kotlin 2.3 with all 9 frameworks pinned (Ktor 3.4.x, CMP 1.10.x, SQLDelight 2.2.x, Koin 4.1.x, Exposed 1.0.x, Arrow 2.2.x, kotlinx-coroutines 1.10.x, kotlinx-serialization 1.10.x, Gradle 8.x). course.json reflects current targets. Build artifacts deleted.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix Module 06 lesson ordering and module title prefixes</name>
  <files>
    content/courses/kotlin/modules/06-backend-development-with-ktor/lessons/*/lesson.json (15 files)
    content/courses/kotlin/modules/05-coroutines-and-flows/module.json
    content/courses/kotlin/modules/08-persistence-with-sqldelight/module.json
    content/courses/kotlin/modules/09-kmp-architecture-patterns/module.json
    content/courses/kotlin/modules/10-dependency-injection-with-koin/module.json
  </files>
  <action>
    **Fix Module 06 lesson ordering (CRITICAL -- most impactful structural fix):**

    The current directory order and lesson.json `order` fields produce this broken sequence:
    01: 5.1 HTTP intro -> 02: 5.10 Auth Registration -> 03: 5.11 Auth Login -> 04: 5.12 Auth Routes -> 05: 5.13 Koin DI -> 06: 5.14 Testing -> 07: 5.15 Capstone -> 08: 5.2 Ktor Setup -> 09: 5.3 Routing -> 10: 5.4 Params -> 11: 5.5 JSON -> 12: 5.6 DB Part 1 -> 13: 5.7 DB Part 2 -> 14: 5.8 Repository -> 15: 5.9 Validation

    The CORRECT progression by lesson number should be:
    01: 5.1 HTTP intro
    02: 5.2 Ktor Setup
    03: 5.3 Routing
    04: 5.4 Request Parameters
    05: 5.5 JSON Serialization
    06: 5.6 Database Part 1
    07: 5.7 Database Part 2
    08: 5.8 Repository Pattern
    09: 5.9 Validation & Error Handling
    10: 5.10 Auth Registration
    11: 5.11 Auth Login JWT
    12: 5.12 Auth Protecting Routes
    13: 5.13 DI with Koin
    14: 5.14 Testing API
    15: 5.15 Capstone

    To fix this, update the `order` field in each lesson.json to match the correct sequence above. The directory prefix numbers (01- through 15-) are tied to the filesystem order -- we need to RENAME directories so the filesystem order matches the logical lesson order.

    Renaming plan (current dir prefix -> new dir prefix):
    - 01-lesson-51-... stays as 01 (correct position)
    - 02-lesson-510-... -> rename to 10-lesson-510-... (auth reg goes to position 10)
    - 03-lesson-511-... -> rename to 11-lesson-511-... (auth login goes to position 11)
    - 04-lesson-512-... -> rename to 12-lesson-512-... (auth routes goes to position 12)
    - 05-lesson-513-... -> rename to 13-lesson-513-... (DI goes to position 13)
    - 06-lesson-514-... -> rename to 14-lesson-514-... (testing goes to position 14)
    - 07-lesson-515-... -> rename to 15-lesson-515-... (capstone goes to position 15)
    - 08-lesson-52-... -> rename to 02-lesson-52-... (Ktor setup goes to position 2)
    - 09-lesson-53-... -> rename to 03-lesson-53-... (routing goes to position 3)
    - 10-lesson-54-... -> rename to 04-lesson-54-... (params goes to position 4)
    - 11-lesson-55-... -> rename to 05-lesson-55-... (JSON goes to position 5)
    - 12-lesson-56-... -> rename to 06-lesson-56-... (DB 1 goes to position 6)
    - 13-lesson-57-... -> rename to 07-lesson-57-... (DB 2 goes to position 7)
    - 14-lesson-58-... -> rename to 08-lesson-58-... (repository goes to position 8)
    - 15-lesson-59-... -> rename to 09-lesson-59-... (validation goes to position 9)

    IMPORTANT: This is a swap operation. To avoid conflicts, use a two-phase rename:
    Phase 1: Rename all directories to temp names (e.g., tmp-01, tmp-02, ...)
    Phase 2: Rename from temp names to final names

    After renaming directories, update the `order` field in each lesson.json to match the new directory prefix number (1 through 15).

    **Fix module title prefixes:**
    - Module 05 module.json: title "Module 04A: Coroutines & Flows" -> "Coroutines & Flows"
    - Module 08 module.json: title "Module 06A: Persistence with SQLDelight" -> "Persistence with SQLDelight"
    - Module 09 module.json: title "Module 06B: KMP Architecture Patterns" -> "KMP Architecture Patterns"
    - Module 10 module.json: title "Module 06C: Dependency Injection with Koin" -> "Dependency Injection with Koin"

    Verify: The directory slug names already have correct descriptive names (coroutines-and-flows, persistence-with-sqldelight, etc.), so titles should match the slug-derived names.
  </action>
  <verify>
    List Module 06 lesson directories and verify they are in logical order (HTTP -> Setup -> Routing -> Params -> JSON -> DB1 -> DB2 -> Repo -> Validation -> Auth1 -> Auth2 -> Auth3 -> DI -> Testing -> Capstone).
    Read each of the 15 lesson.json files and verify `order` field matches directory prefix.
    Read module.json for modules 05, 08, 09, 10 and verify no "Module XXX:" prefix remains.
    Grep for "Module 04A" and "Module 06" across all module.json files to confirm zero matches.
  </verify>
  <done>
    Module 06 lessons reordered from alphabetical-broken (auth before routing) to logical progression (setup -> basics -> database -> auth -> testing -> capstone). All 15 directories renamed and lesson.json order fields updated. Module title prefixes removed from modules 05, 08, 09, 10.
  </done>
</task>

</tasks>

<verification>
1. Version manifest kotlin.runtime.version is "2.3" with all 9 frameworks
2. course.json minimumRuntimeVersion is "Kotlin 2.3"
3. Module 06 directory listing shows logical order (Ktor setup at position 02, auth at position 10+)
4. All 15 Module 06 lesson.json `order` fields match directory prefix numbers
5. Zero "Module 04A" or "Module 06A/B/C" strings remain in any module.json
6. refactor_course.py and course.json.bak deleted
</verification>

<success_criteria>
- Version manifest and course.json aligned to Kotlin 2.3 with full framework stack pinned
- Module 06 lesson ordering fixed (students learn Ktor basics before auth/testing/capstone)
- Module title prefixes cleaned up across 4 modules
- Build artifacts deleted
- Structural foundation clean for accuracy passes
</success_criteria>

<output>
After completion, create `.planning/phases/06-kotlin-course-audit/06-01-SUMMARY.md`
</output>
