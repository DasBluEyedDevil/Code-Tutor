---
phase: 01-foundation-and-content-normalization
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - native-app-wpf/Controls/AnalogySection.xaml
  - native-app-wpf/Controls/AnalogySection.xaml.cs
  - native-app-wpf/Controls/WarningSection.xaml
  - native-app-wpf/Controls/WarningSection.xaml.cs
  - native-app-wpf/Views/LessonPage.xaml.cs
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "ANALOGY content sections render with purple-tinted card styling distinct from generic default sections"
    - "WARNING content sections render with orange-tinted card styling distinct from generic default sections"
    - "All 6 standard content types (THEORY, EXAMPLE, KEY_POINT, ANALOGY, WARNING, LEGACY_COMPARISON) route to dedicated renderers -- no types fall through to CreateDefaultSection()"
  artifacts:
    - path: "native-app-wpf/Controls/AnalogySection.xaml"
      provides: "XAML layout for ANALOGY content type"
      contains: "AnalogySection"
    - path: "native-app-wpf/Controls/AnalogySection.xaml.cs"
      provides: "Code-behind for AnalogySection control"
      contains: "class AnalogySection"
    - path: "native-app-wpf/Controls/WarningSection.xaml"
      provides: "XAML layout for WARNING content type"
      contains: "WarningSection"
    - path: "native-app-wpf/Controls/WarningSection.xaml.cs"
      provides: "Code-behind for WarningSection control"
      contains: "class WarningSection"
    - path: "native-app-wpf/Views/LessonPage.xaml.cs"
      provides: "Switch statement routing all 6 types"
      contains: "\"ANALOGY\""
  key_links:
    - from: "native-app-wpf/Views/LessonPage.xaml.cs"
      to: "native-app-wpf/Controls/AnalogySection.xaml.cs"
      via: "switch case \"ANALOGY\" => new Controls.AnalogySection(section)"
      pattern: "ANALOGY.*AnalogySection"
    - from: "native-app-wpf/Views/LessonPage.xaml.cs"
      to: "native-app-wpf/Controls/WarningSection.xaml.cs"
      via: "switch case \"WARNING\" => new Controls.WarningSection(section)"
      pattern: "WARNING.*WarningSection"
---

<objective>
Close the one gap found in Phase 1 verification: ANALOGY and WARNING content types lack dedicated WPF renderers, causing 946 content sections (405 ANALOGY + 541 WARNING) to fall back to generic default styling.

Purpose: Fully satisfy NORM-02 ("all content sections use standardized type names recognized by the app") and Phase 1 Success Criterion 2 ("the app renders all of them"). Without this, ANALOGY sections (metaphors/real-world comparisons) and WARNING sections (pitfalls/gotchas) are visually indistinguishable from plain text, reducing pedagogical effectiveness.

Output: Two new UserControl pairs (AnalogySection, WarningSection) and an updated switch statement in LessonPage.xaml.cs that routes all 6 standard content types to dedicated renderers.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-and-content-normalization/01-VERIFICATION.md

# Existing pattern to follow
@native-app-wpf/Controls/KeyPointSection.xaml
@native-app-wpf/Controls/KeyPointSection.xaml.cs

# File to modify
@native-app-wpf/Views/LessonPage.xaml.cs

# Color resources available
@native-app-wpf/Themes/Colors.xaml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnalogySection and WarningSection controls</name>
  <files>
    native-app-wpf/Controls/AnalogySection.xaml
    native-app-wpf/Controls/AnalogySection.xaml.cs
    native-app-wpf/Controls/WarningSection.xaml
    native-app-wpf/Controls/WarningSection.xaml.cs
  </files>
  <action>
    Create two new WPF UserControl pairs following the exact pattern of KeyPointSection (simple Border + StackPanel + header TextBlock + content TextBlock). These are NOT complex controls -- they are the simplest content section pattern in the codebase.

    **AnalogySection.xaml:**
    - UserControl class: CodeTutor.Wpf.Controls.AnalogySection
    - Border: Style="{StaticResource CardBorder}", Background="#1A1A2F" (purple-tinted dark, analogous to KeyPointSection's #1A2F1A green-tinted dark), BorderBrush="{StaticResource AccentPurpleBrush}", Margin="0,0,0,24"
    - Header TextBlock: Text="Think of it this way", Style="{StaticResource SubheadingText}", Foreground="{StaticResource AccentPurpleBrush}"
    - Content TextBlock: x:Name="ContentText", Style="{StaticResource BodyText}", TextWrapping="Wrap"

    **AnalogySection.xaml.cs:**
    - Namespace: CodeTutor.Wpf.Controls
    - Constructor takes ContentSection parameter, calls InitializeComponent(), sets ContentText.Text = section.Content
    - Using statements: System.Windows.Controls, CodeTutor.Wpf.Models
    - Exact same structure as KeyPointSection.xaml.cs

    **WarningSection.xaml:**
    - UserControl class: CodeTutor.Wpf.Controls.WarningSection
    - Border: Style="{StaticResource CardBorder}", Background="#2F2A1A" (orange-tinted dark), BorderBrush="{StaticResource AccentOrangeBrush}", Margin="0,0,0,24"
    - Header TextBlock: Text="Warning", Style="{StaticResource SubheadingText}", Foreground="{StaticResource AccentOrangeBrush}"
    - Content TextBlock: x:Name="ContentText", Style="{StaticResource BodyText}", TextWrapping="Wrap"

    **WarningSection.xaml.cs:**
    - Identical structure to AnalogySection.xaml.cs but class name is WarningSection
    - Namespace: CodeTutor.Wpf.Controls
    - Constructor takes ContentSection, calls InitializeComponent(), sets ContentText.Text = section.Content

    **Important:** Do NOT add emoji icons, expanders, or any complexity beyond what KeyPointSection has. These are pedagogical callout boxes, not interactive widgets. Match the KeyPointSection pattern exactly -- only the colors and header text differ.

    **Why these colors:**
    - Purple (#A371F7 / #1A1A2F) for ANALOGY = imagination, metaphor, creative thinking
    - Orange (#D29922 / #2F2A1A) for WARNING = caution, attention (orange is used elsewhere in the app for warnings -- see LandingPage.xaml WarningBackgroundBrush usage and CodingChallenge.xaml AccentOrangeBrush usage)
  </action>
  <verify>
    All 4 files exist in native-app-wpf/Controls/:
    - AnalogySection.xaml contains "AnalogySection" class reference and AccentPurpleBrush
    - AnalogySection.xaml.cs contains "class AnalogySection" and "section.Content"
    - WarningSection.xaml contains "WarningSection" class reference and AccentOrangeBrush
    - WarningSection.xaml.cs contains "class WarningSection" and "section.Content"
  </verify>
  <done>
    Four new files created following the KeyPointSection pattern exactly. AnalogySection uses purple theming with "Think of it this way" header. WarningSection uses orange theming with "Warning" header. Both accept ContentSection in constructor and display section.Content.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire ANALOGY and WARNING into LessonPage switch statement</name>
  <files>
    native-app-wpf/Views/LessonPage.xaml.cs
  </files>
  <action>
    Update the CreateSectionControl method in LessonPage.xaml.cs (currently at line 103-113) to add two new cases to the switch expression BEFORE the default case:

    Change FROM:
    ```csharp
    return section.Type?.ToUpperInvariant() switch
    {
        "THEORY" => new Controls.TheorySection(section),
        "EXAMPLE" => new Controls.CodeExampleSection(section),
        "KEY_POINT" => new Controls.KeyPointSection(section),
        "LEGACY_COMPARISON" => new Controls.LegacyComparisonSection(section),
        _ => CreateDefaultSection(section)
    };
    ```

    Change TO:
    ```csharp
    return section.Type?.ToUpperInvariant() switch
    {
        "THEORY" => new Controls.TheorySection(section),
        "EXAMPLE" => new Controls.CodeExampleSection(section),
        "KEY_POINT" => new Controls.KeyPointSection(section),
        "ANALOGY" => new Controls.AnalogySection(section),
        "WARNING" => new Controls.WarningSection(section),
        "LEGACY_COMPARISON" => new Controls.LegacyComparisonSection(section),
        _ => CreateDefaultSection(section)
    };
    ```

    Place ANALOGY and WARNING before LEGACY_COMPARISON (alphabetical grouping of the common types, with LEGACY_COMPARISON last before the default since it is rare at only 19 sections). The default case must remain for forward compatibility.

    Do NOT modify any other part of LessonPage.xaml.cs. This is a 2-line addition to an existing switch expression.
  </action>
  <verify>
    Read LessonPage.xaml.cs and confirm:
    1. The switch statement contains exactly 6 named cases: THEORY, EXAMPLE, KEY_POINT, ANALOGY, WARNING, LEGACY_COMPARISON
    2. ANALOGY routes to Controls.AnalogySection(section)
    3. WARNING routes to Controls.WarningSection(section)
    4. The default case (_ => CreateDefaultSection) still exists
    5. No other changes were made to the file

    Build check: Run `dotnet build native-app-wpf/` and confirm 0 errors. If the project has dependencies that prevent building in CI, at minimum confirm the file parses (no syntax errors visible).
  </verify>
  <done>
    LessonPage.xaml.cs switch statement routes all 6 standard content types to dedicated renderers. ANALOGY sections (405 across all courses) will render with purple-themed callout styling. WARNING sections (541 across all courses) will render with orange-themed callout styling. No content types fall through to CreateDefaultSection() unless they are an unrecognized future type.
  </done>
</task>

</tasks>

<verification>
Phase 1 gap closure is complete when:
1. `grep -r "ANALOGY.*AnalogySection" native-app-wpf/Views/LessonPage.xaml.cs` returns a match
2. `grep -r "WARNING.*WarningSection" native-app-wpf/Views/LessonPage.xaml.cs` returns a match
3. All 4 new control files exist and follow the KeyPointSection pattern
4. The switch statement has 6 named cases (THEORY, EXAMPLE, KEY_POINT, ANALOGY, WARNING, LEGACY_COMPARISON) plus a default
5. `dotnet build native-app-wpf/` succeeds (if build environment available)
</verification>

<success_criteria>
- All 6 standard content types (THEORY, EXAMPLE, KEY_POINT, ANALOGY, WARNING, LEGACY_COMPARISON) have dedicated WPF renderers
- ANALOGY sections render with purple AccentPurpleBrush border and #1A1A2F background
- WARNING sections render with orange AccentOrangeBrush border and #2F2A1A background
- Phase 1 Success Criterion 2 is fully satisfied: "the app renders all of them"
- NORM-02 requirement is fully satisfied
- No regressions to existing THEORY, EXAMPLE, KEY_POINT, or LEGACY_COMPARISON rendering
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-and-content-normalization/01-06-SUMMARY.md`
</output>
