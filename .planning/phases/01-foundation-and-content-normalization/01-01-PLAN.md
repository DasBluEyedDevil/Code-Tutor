---
phase: 01-foundation-and-content-normalization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .gitignore
  - content/courses/csharp/course.json.bak
  - content/courses/flutter/course.json.bak
  - content/courses/java/course.json.bak
  - content/courses/javascript/course.json.bak
  - content/courses/kotlin/course.json.bak
  - content/courses/python/course.json.bak
autonomous: true

must_haves:
  truths:
    - "No .bak files are tracked by git anywhere in the repository"
    - ".gitignore prevents future .bak files from being committed"
    - "INFR-02 (compiled binaries in git history) is verified as already resolved or cleaned up"
    - "Git working tree is clean after cleanup commit"
  artifacts:
    - path: ".gitignore"
      provides: "Updated ignore rules preventing .bak and binary re-addition"
      contains: "*.bak"
  key_links:
    - from: ".gitignore"
      to: "content/courses/**/*.bak"
      via: "gitignore rule prevents tracking"
      pattern: "\\*\\.bak"
---

<objective>
Clean git infrastructure: remove tracked .bak files, update .gitignore to prevent recurrence, and verify INFR-02 status (compiled binaries in git history).

Purpose: Establish a clean git baseline before any content transformations begin. Every subsequent plan in this phase modifies content files -- starting with tracked backup files and missing ignore rules creates confusion about what is authoritative.

Output: Clean git history with no .bak files tracked, updated .gitignore, and INFR-02 disposition documented.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-and-content-normalization/01-RESEARCH.md
@.gitignore
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update .gitignore and remove tracked .bak files</name>
  <files>.gitignore, content/courses/**/course.json.bak</files>
  <action>
    1. Add `*.bak` to .gitignore in the "Backup files" section (line ~79, alongside existing `*.backup.json` and `*.backup` rules). This MUST happen before removing files from tracking so they do not get re-added.

    2. Remove all 6 tracked .bak files from git index (but leave them on disk since gitignore will now cover them):
       ```
       git rm --cached content/courses/csharp/course.json.bak
       git rm --cached content/courses/flutter/course.json.bak
       git rm --cached content/courses/java/course.json.bak
       git rm --cached content/courses/javascript/course.json.bak
       git rm --cached content/courses/kotlin/course.json.bak
       git rm --cached content/courses/python/course.json.bak
       ```

    3. Also clean up the deleted temp file showing in git status:
       ```
       git rm --cached "temp_flutter_course.json" (if still tracked)
       ```

    4. Verify with `git ls-files "*.bak"` that zero .bak files remain tracked.

    5. Commit: "chore(01-01): remove .bak files from tracking, update .gitignore"
  </action>
  <verify>
    - `git ls-files "*.bak"` returns empty output
    - `git diff --cached --name-only` shows the .gitignore update and .bak removals before commit
    - After commit, `git status` shows clean working tree (the .bak files on disk are now ignored)
  </verify>
  <done>Zero .bak files tracked by git. .gitignore contains `*.bak` rule. Working tree is clean.</done>
</task>

<task type="auto">
  <name>Task 2: Verify INFR-02 (compiled binaries in git history) and document disposition</name>
  <files>None modified -- verification only</files>
  <action>
    1. Run thorough git history search for compiled binaries:
       ```
       git log --all --stat -- "*.dll" "*.exe" "*.pdb" "**/bin/**" "**/obj/**"
       ```
       Also check:
       ```
       git log --all --diff-filter=A -- "content/courses/csharp/capstone/src/ShopFlow.Web/bin/*"
       git log --all --diff-filter=A -- "content/courses/csharp/capstone/src/ShopFlow.Web/obj/*"
       ```

    2. If NO results: INFR-02 is already resolved. The .gitignore already has `**/bin/` and `**/obj/` rules (lines 13-14) preventing future checkins.

    3. If binaries ARE found in history: Use `git filter-repo` or BFG Repo-Cleaner to purge them. Run:
       ```
       # If git-filter-repo is available:
       git filter-repo --invert-paths --path-glob "*.dll" --path-glob "*.exe" --path-glob "*.pdb"
       # OR if BFG is available:
       java -jar bfg.jar --delete-files "*.dll" --delete-files "*.exe" --delete-files "*.pdb"
       ```
       Then `git reflog expire --expire=now --all && git gc --prune=now --aggressive`

    4. Document the finding in the SUMMARY. If resolved, note "INFR-02: Already resolved -- no compiled binaries found in git history. Existing .gitignore rules prevent future checkins."
  </action>
  <verify>
    - `git log --all --stat -- "*.dll" "*.exe" "*.pdb"` returns empty output (either was always empty or has been cleaned)
    - .gitignore already contains `**/bin/` and `**/obj/` rules (verify lines 13-14 exist)
  </verify>
  <done>INFR-02 status is verified and documented. If binaries existed, they are purged. If not, the requirement is marked resolved with evidence.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `git ls-files "*.bak"` returns nothing
2. `git log --all --stat -- "*.dll" "*.exe" "*.pdb"` returns nothing
3. `.gitignore` contains `*.bak` rule
4. `.gitignore` contains `**/bin/` and `**/obj/` rules
5. `git status` shows clean working tree
</verification>

<success_criteria>
- INFR-01 satisfied: No .bak files tracked by git
- INFR-02 verified: Compiled binaries confirmed absent from git history (or purged)
- INFR-04 partially satisfied: .gitignore updated with `*.bak` rule (binary rules already existed)
- Git working tree is clean, ready for schema standardization work
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-and-content-normalization/01-01-SUMMARY.md`
</output>
